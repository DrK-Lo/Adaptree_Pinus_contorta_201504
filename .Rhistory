?read.table
?strsplit
?vennDiagram
source("http://www.bioconductor.org/biocLite.R")
class(biocLite)
biocLite("limma")
library(limma)
?vennDiagram
filename <- flist[i]#"var_out_GATK3_allhet_pine688_ALL.summary.ALL.annots.sorted.GOOD.window.3xbf.log10gtV.999"
cutoff <- sub("*gtV","",flist[i])
?sub
installed.packages()
groupsize <- tapply(env$G4,env$G4, length)
groupsize2 <- groupsize[2:4]/sum(groupsize[2:4])
getwd()
env <- read.table("sprucePineEnvi.clusters", header=TRUE)
env
env <- read.table("envi clusters/sprucePineEnvi.clusters", header=TRUE)
env
groupsize <- tapply(env$G4,env$G4, length)
groupsize2 <- groupsize[2:4]/sum(groupsize[2:4])
groupsize2
ls()
version()
sessioninfo()
sessionInfo()
?knitr::kable
?colnames
?xtable
if(!("xtable" %in% installed.packages())) {install.packages("xtable", dependencies=TRUE)}
library(xtable)
xtable
?xtable
data.frame(c(TRUE,TRUE,FALSE,FALSE), c(FALSE, TRUE, FALSE, TRUE))
a<-data.frame(c(TRUE,TRUE,FALSE,FALSE), c(FALSE, TRUE, FALSE, TRUE))
vennCounts(a)
?colSums
matrix(c(.9,.1,.8,.2), ncol=2)
a <- matrix(c(.9,.1,.8,.2), ncol=2)
barplot(a)
?barplot
barplot(a, beside=TRUE)
rownames(a) <-
c("A", "B")
barplot(a, beside=TRUE)
a
a <- data.frame(a)
barplot(a, beside=TRUE)
a<- as.matrix(a)
barplot(a, beside=TRUE)
head(a)
env
?barplot
cutoff[which.cutoffs]
?text
?par
dat <- matrix(rnorm(44), nrow=2)
rownames(dat)<-env$enviAbb
colnames(dat)<-env$enviAbb
barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="")
which.cutoffs<-1:2
barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="")
barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="", xaxt="n")
text(1:22, par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = paste(rownames(dat)), cex=0.65)
paste(rownames(dat)
)
dat
text(1:22, par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
text(seq(1.5:44.5,by=2), par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
text(seq(1.5,44.5,by=2), par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
end_point = 0.5 + nrow(dat) + nrow(dat)-1 #this is the line which does the trick (together with barplot "space = 1" parameter)
end_point
dat <- as.matrix(t(envitable.perc[3:ncol(envitable.perc)]))
barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="", xaxt="n", space=1)
barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="", xaxt="n")
a<- barplot(dat, beside=TRUE,  ylab="Proportion of total outliers",              legend.text=names(cos)[which.cutoffs], cex.names=0.8,
xlab="", xaxt="n")
a
text(a[1,]+0.5, par("usr")[3]-0.25,
srt = 60, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
text(a[1,]+0.5, par("usr")[3]-0.25,
srt = 90, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
cex.names=0.8,
# cex.names=0.8,
dat <- as.matrix(runif(44), nrow=2)
colnames(dat) <- rep("name", 44)
colnames(dat) <- rep("name", 22)
dat <- as.matrix(runif(44), nrow=2)
colnames(dat) <- rep("name", 22)
dim(dat)
dat <- matrix(runif(44), nrow=2)
colnames(dat) <- rep("name", 22)
a<- barplot(dat, beside=TRUE,
ylab="Proportion of total outliers",
legend.text=names(cos)[which.cutoffs],
cex.names=0.8,
xlab="", xaxt="n")
text(a[1,]+0.5, par("usr")[3]-0.25,
srt = 90, adj= 1, xpd = TRUE,
labels = paste(colnames(dat)), cex=0.65)
?text
setwd("~/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_src/envi_clusters")
setwd("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_src/envi_clusters")
if(!("rmarkdown" %in% installed.packages())) {install.packages("rmarkdown", dependencies=TRUE)}
if(!("limma" %in% installed.packages())) {
source("http://www.bioconductor.org/biocLite.R")
biocLite("limma")
}
if(!("xtable" %in% installed.packages())) {install.packages("xtable", dependencies=TRUE)}
library(rmarkdown)
library(limma)
library(xtable)
sessionInfo()
env <- read.table("sprucePineEnvi.clusters", header=TRUE)
env
env <- read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi2")
head(env)
in2 <- t (env)
in3 <- prcomp (in2, scale. = T)
head(in3)
str(in3)
scores <- t (in3$x)
head(scores)
str(in3)
plot(scores)
dim(scores)
plot(scores[,1], scores[,2])
plot(scores[,1], scores[,2], labels = 1:279)
plot(scores[,1], scores[,2])
plot(scores[,1], scores[,2])
str(in3)
barplot(in3$sdev)
barplot(in3$sdev, ylab="Standard Deviation", names.arg = 1:22, xlab="PC axis")
hist(in3$scale)
popnames <- read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.finalpops2")
popnames <- read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2")
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2")
head(popnames)
popnames <- as.character(read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2"))
head(popnames)
popnames <- unlist(read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2"))
head(popnames)
popnames <- as.character(unlist(read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2")))
head(popnames)
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2")
text(scores[,1], scores[,2], popnames)
plot(scores[,1], jitter(scores[,2]), xlab="PC 1", ylab="PC 2")
plot(scores[,1], jitter(scores[,2],factor = 2), xlab="PC 1", ylab="PC 2")
popnames
text(scores[,1], scores[,2], popnames)
text(scores[,1], scores[,2], popnames, cex=0.5)
plot(scores[,1], (scores[,2]), xlab="PC 1", ylab="PC 2")
plot(scores[,1], (scores[,2]), xlab="PC 1", ylab="PC 2", col=0)
text(scores[,1], scores[,2], popnames, cex=0.5)
plot(jitter(scores[,1]), jitter(scores[,2]), xlab="PC 1", ylab="PC 2", col=0)
plot(jitter(scores[,1]), jitter(scores[,2]), xlab="PC 1", ylab="PC 2")#, col=0)
plot(jitter(scores[,1]), jitter(scores[,2]), xlab="PC 1", ylab="PC 2", col=rgb(0,0,0,0.5))
length(scores[,1])
env.clust
env.clust <- read.table("sprucePineEnvi.clusters", header=TRUE)
env.clust
text(scores[,1], scores[,2], envi.clust$envi.Abb, cex=0.7)
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=rgb(0,0,0,0.5), pch=19)
text(scores[,1], scores[,2], envi.clust$envi.Abb, cex=0.7)
env.clust
text(scores[,1], scores[,2], env.clust$envi.Abb, cex=0.7)
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5))
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
par(mfrow=c(2,2), mar=c(4,4,1,1))
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="n")
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
par(mfrow=c(2,2), mar=c(4,4,1,1))
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,3], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,3], xlab="PC 1", ylab="PC3", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
plot()
plot(scores[,3], scores[,2], xlab="PC 3", ylab="PC2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
plot(scores[,3], scores[,2], xlab="PC 3", ylab="PC2", col=0, bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,3], xlab="PC 1", ylab="PC3", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
plot(scores[,3], scores[,2], xlab="PC 3", ylab="PC2", col=0, bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
text(scores[,3], scores[,2], env.clust$enviAbb, cex=0.7)
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(scores[,1], scores[,2], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,1], scores[,3], xlab="PC 1", ylab="PC3", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[,1], scores[,3], env.clust$enviAbb, cex=0.7)
plot(scores[,3], scores[,2], xlab="PC 3", ylab="PC2", col=0, bty="l", xlim=c(-4.5,1))
text(scores[,3], scores[,2], env.clust$enviAbb, cex=0.7)
plot(scores[,3], scores[,4], xlab="PC 3", ylab="PC4", col=0, bty="l", xlim=c(-4.5,1))
text(scores[,3], scores[,4], env.clust$enviAbb, cex=0.7)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[1,], scores[2,], popnames, cex=0.7)
?strsplit
popnames <- sub("Pi_", "", as.character(unlist(read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2"))))
head(popnames)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-3.5, 0.5), bty="l")
text(scores[1,], scores[2,], popnames, cex=0.7)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0, xlim=c(-5, 5), bty="l")
text(scores[1,], scores[2,], popnames, cex=0.7)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l")
text(scores[1,], scores[2,], popnames, cex=0.7)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
par(mfcol=c(1,1), mar=c(4,4,1,1))
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[2,], popnames, cex=0.7)
?pr.comp
?prin.comp
?princ.comp
?prcomp
loadings <- in3$rotation
loadings
dim(loadings)
str(loadings)
names(loadings)
colNames(loadings)
head(loadings)
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l")
text(loadings[,1], loadings[,2], env.clust$enviAbb)
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l", xlim=c(-0.3,0.4))
text(loadings[,1], loadings[,2], env.clust$enviAbb)
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l", xlim=c(-0.3,0.4))
text(loadings[,1], loadings[,2], env.clust$enviAbb)
plot(loadings[,1], loadings[,3], xlab="PC1", ylab="PC3", col=0, bty="l", xlim=c(-0.3,0.4))
text(loadings[,1], loadings[,3], env.clust$enviAbb)
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,2], env.clust$enviAbb)
plot(loadings[,1], loadings[,3], xlab="PC1", ylab="PC3", col=0, bty="l", xlim=c(-0.5,0.4))
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,2], env.clust$enviAbb, cex=0.7)
plot(loadings[,1], loadings[,3], xlab="PC1", ylab="PC3", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,3], env.clust$enviAbb, cex=0.7)
par(mfcol=c(2,2), mar=c(4,4,1,1))
plot(loadings[,1], loadings[,2], xlab="PC1", ylab="PC2", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,2], env.clust$enviAbb, cex=0.7)
plot(loadings[,1], loadings[,3], xlab="PC1", ylab="PC3", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,3], env.clust$enviAbb, cex=0.7)
plot(loadings[,1], loadings[,4], xlab="PC1", ylab="PC4", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,4], env.clust$enviAbb, cex=0.7)
plot(loadings[,1], loadings[,5], xlab="PC1", ylab="PC5", col=0, bty="l", xlim=c(-0.5,0.4))
text(loadings[,1], loadings[,5], env.clust$enviAbb, cex=0.7)
plot(loadings[,1], 1)
plot(loadings[,1], rep(1,22))
plot(loadings[,1], jitter(rep(1,22)))
plot(loadings[,1], 0.1*(1:22), bty="l")
plot(loadings[,1], 0.1*(1:22), bty="l", yaxt="n")
0.1*1:22
plot(loadings[,1], 0.1*(rank(loadings[,1])), bty="l", yaxt="n")
plot(loadings[,pc], 0.1*(rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
pc<-1
plot(loadings[,pc], 0.1*(rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
plot(loadings[,pc], 0.01*(rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
text(loadings[,1], loadings[,2], env.clust$enviAbb, cex=0.7)
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb, cex=0.7)
plot(loadings[,pc], 2*(rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb, cex=0.7)
text(loadings[,pc], 2*(rank(loadings[,pc])), env.clust$enviAbb, cex=0.7)
par<-mfrow(c(1,1), mar=c(4,0,0,0))
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
par(mfrow=c(1,1), mar=c(4,0,0,0))
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc))
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb, cex=0.5)
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc), col=0)
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb)
loadings[,1:5]
rowNames(loadings) <- env.clust$enviAbb
rownames(loadings) <- env.clust$enviAbb
print(xtable(loadings[,1:5]), type="html")
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc), col=0, xlim=c(min(loadings[,pc])*1.5, max(loadings[,pc])*1.5))
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb)
makePCplot <- function(pc){
plot(loadings[,pc], (rank(loadings[,pc])), bty="l", yaxt="n", ylab="", xlab=paste("PC", pc), col=0, xlim=c(min(loadings[,pc])*1.5, max(loadings[,pc])*1.5))
text(loadings[,pc], (rank(loadings[,pc])), env.clust$enviAbb)
}
makePCplot(1)
makePCplot(2)
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[2,], popnames, cex=0.7)
par(mfcol=c(1,1), mar=c(4,4,1,1))
popnames <- sub("Pi_", "", as.character(unlist(read.table("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_data/var_out_pine_all_COMBINED.table.contig_flt10.bayenv.envi.finalpops2"))))
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[2,], popnames, cex=0.7)
par(mfcol=c(2,1), mar=c(4,4,1,1))
par(mfcol=c(2,1), mar=c(4,4,1,1))
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[2,], popnames, cex=0.7)
plot(scores[1,], scores[3,], xlab="PC 1", ylab="PC 3", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[3,], popnames, cex=0.7)
par(mfcol=c(2,1), mar=c(4,4,0,1))
plot(scores[1,], scores[2,], xlab="PC 1", ylab="PC 2", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[2,], popnames, cex=0.7)
plot(scores[1,], scores[3,], xlab="PC 1", ylab="PC 3", col=0,  bty="l", xlim=c(-6,13))
text(scores[1,], scores[3,], popnames, cex=0.7)
head(env)
i=1
hist(env[,i])
var(env[,i])
sd(env[,1])
sd(env[,i])
hist(env[,i], main=env.clust$enviAbb[i], xlab="")
par(mfrow=c(1,1), mar=c(2,4,2,1))
for (i in 1:22){
hist(env[,i], main=env.clust$enviAbb[i], xlab="")
}
par(mfrow=c(1,1), mar=c(2,4,2,1))
for (i in 1:22){
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value")
}
i=2
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value")
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=50)
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=20)
i=1
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=20)
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
i=10
hist(env[,i], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
head(env)
hist(env[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
i=1
hist(env[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
str(env)
env2<-matrix(env)
str(env2)
hist(env2[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
env2<-matrix(unlist(env), ncol=ncol(env))
str(env2)
hist(env2[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=10)
hist(env2[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=20)
i=2
hist(env2[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=20)
vvar(env[,i])
var(env[,i])
sd(env2[i,])
sd(env2[2,])
sd(env2[3,])
sd(env2[4,])
setwd("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_src/envi_clusters")
env.clust <- read.table("sprucePineEnvi.clusters", header=TRUE)
env.clust
setwd("/Users/katie/Desktop/AdaptreeData/2015_POST_FILTERING/pine_src/")
rownames(loadings) <- env.clust$envi.Abb
(loadings[,1:5])
data.frame(env.clust$envi.Abb, loadings[,1:5])
rownames(loadings) <- env.clust$enviAbb
loadings[,1:5]
par(mfrow=c(1,1), mar=c(4,4,2,1))
for (i in 1:22){
hist(env2[i,], main=env.clust$enviAbb[i], xlab="Standardized environmental value", breaks=20)
}
names(env.clust)
hist(env2[i,], main=env.clust$enviAbb[i], xlab=env.clust$enviDesc[i], breaks=20)
hist(env2[i,], main=env.clust$enviAbb[i], xlab=env.clust$enviDesc[i], breaks=20,
xlim=c(-3,3))
i=1
hist(env2[i,], main=env.clust$enviAbb[i], xlab=env.clust$enviDesc[i], breaks=20,
xlim=c(-3,3))
min(env2)
max(env2)
hist(env2[i,], main=env.clust$enviAbb[i], xlab=env.clust$enviDesc[i], breaks=20,
xlim=c(-5,8), breaks=seq(-5,8,0.2))
hist(env2[i,], main=env.clust$enviAbb[i], xlab=env.clust$enviDesc[i],
xlim=c(-5,8), breaks=seq(-5,8,0.2))
fig
?sapply
?tapply
?apply
?max
?is.infinite
?tapply
a<- matrix(rnorm(12), ncol=4)
barplot(a, beside=TRUE)
a
?merge
merge(data.frame(a=1,b=2,c=3), data.frame(a=1,c=2))
a<- data.frame(a=1,b=2,c=3)
a
b <- data.frame(a=1,c=2)
b
merge(a,b)
merge(a,b, all.x)
merge(a,b, all.y=TRUE)
merge(a,b, all.y=TRUE, all.x=TRUE)
get.prop.newannot <- function(V, ind, rowname=NULL){
a<- tapply(V[ind], new.annot[ind], length)
a2<- data.frame(t(a/sum(a)))
rownames(a2) <- rowname
}
?rownames
get.prop.newannot <- function(V, ind, rowname=NULL){
a<- tapply(V[ind], new.annot[ind], length)
a2<- data.frame(t(a/sum(a)))
rownames(a2) <- rowname
a2
}
?xtable
?sum
?hist
?barplot
?legend
?barplot
?vennDiagram
a<-c("b", "a")
b<-c("c", "a", "b")
a%in%b
b%in%a
names(f2)[colBF]==env$enviAbb
?identical
